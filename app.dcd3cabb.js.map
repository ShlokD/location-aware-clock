{"version":3,"sources":["app.js"],"names":["padZero","num","isPM","date","Date","getHours","toTitleCase","text","slice","toLowerCase","Image","src","image","document","querySelector","setAttribute","callback","addEventListener","Clock","time","start","bind","hours","textContent","getMinutes","getSeconds","setInterval","LocationWidget","locationText","city","split","map","join","startApp","featuredImageSrc","window","innerWidth","innerHeight","locationWidget","clock","onLoad","updateText","showImage","setImageSrc","navigator","geolocation","getCurrentPosition","position","latitude","coords","longitude","controller","timeout","AbortController","setTimeout","abort","createAbortController","fetch","signal","then","res","json","response","setCity","catch"],"mappings":"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","file":"app.dcd3cabb.js","sourceRoot":"..","sourcesContent":["// utility functions\r\nconst padZero = (num) => (num >= 10 ? num : `0${num}`);\r\n\r\nconst isPM = () => {\r\n  const date = new Date();\r\n  return date.getHours() > 12;\r\n};\r\n\r\nconst toTitleCase = (text) => text[0] + text.slice(1).toLowerCase();\r\n\r\n// UI Widgets\r\nclass Image {\r\n  constructor(src) {\r\n    this.image = document.querySelector(\"#featured-image\");\r\n    this.src = src;\r\n  }\r\n\r\n  setImageSrc(src) {\r\n    this.src = src;\r\n    this.image.setAttribute(\"src\", this.src);\r\n  }\r\n\r\n  onLoad(callback) {\r\n    this.image.addEventListener(\"load\", callback);\r\n  }\r\n}\r\n\r\nclass Clock {\r\n  constructor() {\r\n    this.time = document.querySelector(\"#time\");\r\n    this.start = this.start.bind(this);\r\n  }\r\n\r\n  start() {\r\n    const date = new Date();\r\n    const hours = date.getHours();\r\n    this.time.textContent = `${padZero(hours)}:${padZero(\r\n      date.getMinutes()\r\n    )}:${padZero(date.getSeconds())}`;\r\n\r\n    setInterval(this.start, 1000);\r\n  }\r\n}\r\n\r\nclass LocationWidget {\r\n  constructor() {\r\n    this.locationText = document.querySelector(\"#location\");\r\n    this.city = \"\";\r\n  }\r\n\r\n  setCity(city) {\r\n    this.city = city;\r\n  }\r\n\r\n  updateText() {\r\n    if (!this.city) {\r\n      this.locationText.textContent = \"Namaste!\";\r\n    } else {\r\n      this.locationText.textContent = `${this.city\r\n        .split(\" \")\r\n        .map(toTitleCase)\r\n        .join(\" \")}`;\r\n    }\r\n  }\r\n}\r\n\r\n// init code\r\n\r\nconst startApp = () => {\r\n  let featuredImageSrc = `https://source.unsplash.com/random/${\r\n    window.innerWidth\r\n  }x${window.innerHeight - 4}?${isPM() ? \"night\" : \"day\"}`;\r\n  const locationWidget = new LocationWidget();\r\n  const clock = new Clock();\r\n  const image = new Image(featuredImageSrc);\r\n\r\n  image.onLoad(() => {\r\n    locationWidget.updateText();\r\n    clock.start();\r\n  });\r\n\r\n  const showImage = () => image.setImageSrc(featuredImageSrc);\r\n\r\n  const createAbortController = ({ timeout }) => {\r\n    const controller = new AbortController();\r\n    setTimeout(() => controller.abort(), timeout);\r\n    return controller;\r\n  };\r\n\r\n  const onSuccess = (position) => {\r\n    const latitude = position.coords.latitude;\r\n    const longitude = position.coords.longitude;\r\n    const controller = createAbortController({ timeout: 4000 });\r\n\r\n    fetch(\r\n      `https://cors-anywhere.herokuapp.com/https://geocode.xyz/${latitude},${longitude}?geoit=json`,\r\n      { signal: controller.signal }\r\n    )\r\n      .then((res) => res.json())\r\n      .then((response) => {\r\n        const { city } = response;\r\n        featuredImageSrc += `,${city.toLowerCase()}`;\r\n        locationWidget.setCity(city);\r\n        showImage();\r\n      })\r\n      .catch(showImage);\r\n  };\r\n\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(onSuccess, () => showImage());\r\n  } else {\r\n    showImage();\r\n  }\r\n};\r\n\r\nwindow.addEventListener(\"load\", startApp);\r\n"]}